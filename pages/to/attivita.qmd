---
title: "Attività di trappolaggio"
description: "Riassunto dell'attività di trappolaggio per settore"
lang: it-IT
format: dashboard
---

```{r setup, include=FALSE}
source("../../scripts/importQfieldCloud.R")
source("../../scripts/calcoliTrappole.R")


```

# Situazione delle trappole

Attualmente su `r nrow(trap)` trappole posate ne sono attive `r nrow(trap[attive,])` trappole di queste `r nrow(trap[controllate,])` sono state controllate negli ultimi `r giorniXcontrollata` giorni (tabella ...).



```{r tabellaBuffer, echo=FALSE, warning=FALSE}
# tabella con il numero di trappole per classi di distanza dal nido più vicino
tabTrapBuffer <- data.frame(
  distanza = attributes(table(
    cut(
      trap$distanzaNido,
      breaks = c(0, buffer$distance, Inf),
      dig.lab = 7
    )
  ))$dimnames[[1]],
  totali = as.integer(table(cut(
    trap$distanzaNido,
    breaks = c(0, buffer$distance, Inf)
  ))),
  attive = as.integer(table(cut(
    trap$distanzaNido[attive],
    breaks = c(0, buffer$distance, Inf)
  ))),
  controllate = as.integer(table(cut(
    trap$distanzaNido[controllate],
    breaks = c(0, buffer$distance, Inf)
  )))
)

tabTrapBuffer <- rbind(
  tabTrapBuffer,
  data.frame(
    distanza = "Totale",
    totali = sum(tabTrapBuffer$totali),
    attive = sum(tabTrapBuffer$attive),
    controllate = sum(tabTrapBuffer$controllate)
  )
  
)

#tabTrapBuffer

knitr::kable(tabTrapBuffer, format = "html", caption = "Numero di trappole per classi di distanza dal nido più vicino; attive sono le trappole non rimosse, controllate sono le trappole non rimosse e controllate almeno una volta negli ultimi 30 giorni")

```

## Intensità di trappolaggio

```{r tabellaDensitaBuffer, echo=FALSE, warning=FALSE}
# tabella con la densità di trappole per km2 nelle aree buffer
#numero di trappole per buffer
tabDensity <- data.frame(
  distanza = buffer$distance,
  n = buffer$nTrappoleControllate,
  area = round(buffer$area, 2),
  densita = round(buffer$densita, 2)
  
)

knitr::kable(tabDensity, format = "html", caption = "Densità di trappole controllate per km2 nelle aree buffer")

```

# Controlli

<!--  grafico a barre del numero di controlli per giorno (FACILE) -->
<!-- istogramma per mesi intervallo di controllo -->
<!-- tabelle media intervalli per mese -->


